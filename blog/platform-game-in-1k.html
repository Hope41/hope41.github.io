<!DOCTYPE html>
<html lang = en-GB id = html>
    <head>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-2MDQ9F697V"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-2MDQ9F697V');
        </script>

        <meta charset = UTF-8>
        <meta name = viewport content = 'width=device-width, initial-scale=1.0'>
        <meta name = description content = "Make a JavaScript platform game in 1K. A tutorial about minifying, code golfing, game development tips">
        <meta name = author content = 'Joachim Ford'>

        <meta property = og:title content = 'Make a Platform Game in 1K of JavaScript - Joachim Ford'>
        <meta property = og:description content = "Make a JavaScript platform game in 1K. A tutorial about minifying, code golfing, game development tips">
        <meta property = og:image content = https://joachimford.uk/assets/logo.png>

        <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" />
        <link rel="shortcut icon" href="/favicon/favicon.ico" />
        <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
        <meta name="apple-mobile-web-app-title" content="Joachim" />
        <link rel="manifest" href="/favicon/site.webmanifest" />

        <title>Make a Platform Game in 1K of JavaScript - Joachim Ford</title>
        <link rel = stylesheet href = /assets/styles.css>
        <link rel = stylesheet href = /assets/topnav.css>
        <link rel = stylesheet href = /assets/main.css>
        <link rel = stylesheet href = /assets/hero.css>
        <link rel = stylesheet href = /assets/infinite-carousel.css>
        <link rel = stylesheet href = /assets/forms.css>
        <link rel = stylesheet href = /assets/footer.css>
        <link rel = stylesheet href = /assets/a.css>
        <link rel = stylesheet href = /assets/demo.css>
        <link rel = stylesheet href = /assets/cool-text.css>
        <link rel = stylesheet href = /assets/deco.css>
        <link rel = stylesheet href = /assets/comment.css>
        <link rel = stylesheet href = /assets/checkbox.css>
        <link rel = stylesheet href = /assets/popup.css>
        <link rel = stylesheet href = /assets/lightbox.css>
        <link rel = stylesheet href = /assets/code.css>

        <link rel = stylesheet href = /assets/controls.css>
    </head>
    <body class = dark>
        <div class = over-hold>
            <section class = topnav>
                <div class = topnav-container>
                    <a class = topnav-home href = /index#>
                        <div class = topnav-logo>
                            <img src = /assets/logo.png alt = 'Pixel art of a young boy with black hair'>
                        </div>
                        <div class = topnav-title>
                            <h2>Joachim</h2>
                            <h2>Ford.uk</h2>
                        </div>
                    </a>
                    <div class = topnav-menu>
                        <div class = topnav-menu-wide>
                            <a href = /games#>Games</a>
                            <a href = /projects#>Projects</a>
                            <a href = /blog# class = active>Blog</a>
                        </div>

                        <div class = topnav-separator></div>

                        <div id = color-theme>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="-6.5 0 13 13">
                                <path d="M 0 0 A 2.25 2.25 90 0 0 0 13 A 2.25 2.25 90 0 0 0 0 Z M 0 2 A 2.25 2.25 90 0 1 0 11 Z"/>
                            </svg>
                        </div>

                        <div class = topnav-separator></div>

                        <div class = topnav-vertical-menu>
                            <a href = /news#>News</a>
                            <a href = /about#>About</a>
                            <a href = /contact#>Contact</a>
                        </div>
                    </div>

                    <div id = nav-bars>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="-0.5 -0.5 4 3">
                            <path stroke-width=".5" stroke="" stroke-linecap="round" stroke-linejoin="round" d="M 0 0 L 3 0 M 0 1 L 3 1 M 0 2 L 2 2"/>
                        </svg>
                    </div>
                </div>
            </section>

            <section class = hero-section>
                <div class = hero-background>
                    <img src = /assets/platform-game-in-1k-original.png>
                </div>
                <div id = hero class = transparent-bg>
                </div>
            </section>

            <section class = main>
                <div class = main-date>4 Aug. 2024</div>
                <div class = 'content top-big-pad bottom'>
                    <h1 class = 'h1 top-big center bottom-big'>Make a Platform Game in 1K of JavaScript</h1>

                    <div class = 'demo-img-container padded-side top-pad bottom-pad'>
                        <div>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-original.png>
                            </div>
                        </div>
                    </div>

                    <div class = 'text shift top-big bottom-big'>
                        <p class = spaced>
                            The game Splash Dash was my entry to a competition
                            running from July to August 2024. In this blog post,
                            we'll try to make it ourselves, line by line.
                        </p>

                        <p class = spaced>
                            When I started writing this, I sort of forgot how
                            difficult these projects are to explain. We will
                            go into very extreme detail - but no pressure! Feel
                            free to flick through this page at your own pace.
                        </p>
                    </div>

                    <a class = 'button center top-big bottom' href = /assets/splash-dash target = _blank>
                        Play Splash Dash
                        <svg class = button-arrow xmlns="http://www.w3.org/2000/svg" viewBox="-1.5 -1.5 5 7">
                            <path d="M 0 0 L 2 2 L 0 4"/>
                        </svg>
                    </a>

                    <div class = 'text shift top-big bottom-big'>
                        <p class = spaced>
                            Here is the entire source code for the game.
                            Just for the record, you're not supposed to understand
                            it.
                        </p>
                    </div>

                    <div class = 'code-holder top bottom'>
                        <div class = code-buttons>
                            <a href = /assets/splash-dash>
                                <div data-tip = 'run' class = 'code-run code-button-icon'>
                                    <img src = /assets/run.svg alt = 'play icon'>
                                </div>
                            </a>
                            <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                <img src = /assets/copy.svg alt = 'copy icon'>
                            </div>
                        </div>
                        <pre class = code><span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">canvas</span> <span style="color:var(--variable)">id</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span><span style="color:var(--operator)">>&lt;</span><span style="color:var(--variable)">script</span><span style="color:var(--operator)">></span><span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">p</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'(e,d)Q&lt;17&amp;!PeightO0,NNNWLr(KfoKJ=d:Ikey x,y=c./2o.fillRect(+.),4,.1e==>S(e=innerd=(i-1Styl"#+=-e)*u+HA(d5,e(d,eA)|	5)M[i-d)*u+W,(&amp;&amp;(=Q=>*Math.sin(+1]==e. Codel=n=>{JWwidthWidth6,HhOHO6,ogetContext`2d`,u=(W+H)5,r=,l,f)=>l,u*f,u*fC=d,F=e,g&amp;s?f=-.18:ef.007,h?d-=.1:qd.1t,KLKs=N9,WA&amp;!	&amp;!)e%1&lt;fF,s=1,f=0	)|A||d&lt;0|d5>70C,	)f=NF)ePA)&amp;a)>k[~~d*~~e]=1R=Nx=70;x--;)Jy=30;y--;)"+~(5x)-543A()?K,1):a()>&amp;yPk[x*y]ff0",Kx4,y41p/50+x+R++.3));JK-W,NWK7L034",L-m*W/5e3,H/9r+f,.4rKd3,e0698",i=634;i-=2;o.lineTo(/9]+13))p?(]*>3(]02p*)-),~=~/9)&amp;e>12&amp;e&lt;14?f/4:*=.97*&lt;630-=]5):M.push(N0);KN13,70(R?++m>5e3?C:p9:T>4?t="#ff0":k=[T*=14,Tm=1],requestAnimationFrame(l)},f=g=h=q=s=u=T=m=p=Nk=[M=[]],t="#3897",S38|87?gI39|68?qI37|65?hINon down,1on upa(1+~~e,~~d,6d*e*9+T)+d5AaQ>Nl()'</span>;<span style="color:var(--variable)">G</span><span style="color:var(--operator)">=/</span>[^!<span style="color:var(--operator)">-</span><span style="color:var(--variable)">HMR</span><span style="color:var(--operator)">-</span>~]<span style="color:var(--operator)">/</span>.<span style="color:var(--function)">exec</span>(<span style="color:var(--variable)">p</span><span style="color:var(--operator)">)</span>;<span style="color:var(--operator)">)</span><span style="color:var(--keyword)">with</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">p</span>.<span style="color:var(--function)">split</span>(<span style="color:var(--variable)">G</span><span style="color:var(--operator)">))</span><span style="color:var(--variable)">p</span><span style="color:var(--operator)">=</span><span style="color:var(--function)">join</span>(<span style="color:var(--function)">shift</span>(<span style="color:var(--operator)">))</span>;<span style="color:var(--keyword)">eval</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">p</span><span style="color:var(--operator)">)&lt;/</span><span style="color:var(--variable)">script</span><span style="color:var(--operator)">></span></pre>
                    </div>

                    <h2 class = 'h2 top-huge center bottom-big'>Table of Contents</h2>
                    <div class = 'text shift'>
                        <p class = spaced>
                            <span class = bullet-point>
                                <a class = basic-link id = _intro href = #intro>
                                    Introduction
                                </a>
                            </span>

                            <span class = bullet-point>
                                <a class = basic-link id = _game href = #game>
                                    Coding the Game From Scratch
                                </a>
                            </span>

                            <span class = 'bullet-point indent-1'>
                                <a class = basic-link id = _setup href = #setup>
                                    Step 1. Setting Up
                                </a>
                            </span>

                            <span class = 'bullet-point indent-1'>
                                <a class = basic-link id = _character href = #character>
                                    Step 2. The Character
                                </a>
                            </span>

                            <span class = 'bullet-point indent-1'>
                                <a class = basic-link id = _blocks href = #blocks>
                                    Step 3. Blocks and Gravity
                                </a>
                            </span>

                            <span class = 'bullet-point indent-1'>
                                <a class = basic-link id = _collision href = #collision>
                                    Step 4. Tiny Collision
                                </a>
                            </span>

                            <span class = 'bullet-point indent-1'>
                                <a class = basic-link id = _jumping href = #jumping>
                                    Step 5. Jumping
                                </a>
                            </span>

                            <span class = 'bullet-point indent-1'>
                                <a class = basic-link id = _worlds href = #worlds>
                                    Step 6. Making Worlds
                                </a>
                            </span>

                            <span class = 'bullet-point indent-2'>
                                <a class = basic-link id = _formula href = #formula>
                                    Part 1. The Basic Formula
                                </a>
                            </span>

                            <span class = 'bullet-point indent-2'>
                                <a class = basic-link id = _coins href = #coins>
                                    Part 2. Adding Coins
                                </a>
                            </span>

                            <span class = 'bullet-point indent-2'>
                                <a class = basic-link id = _water href = #water>
                                    Part 3. Simulating Water
                                </a>
                            </span>

                            <span class = 'bullet-point indent-2'>
                                <a class = basic-link id = _levels href = #levels>
                                    Part 4. Playable Levels
                                </a>
                            </span>

                            <span class = 'bullet-point indent-2'>
                                <a class = basic-link id = _details href = #details>
                                    Part 5. Final Details
                                </a>
                            </span>

                            <span class = bullet-point>
                                <a class = basic-link id = _code href = #code>
                                    One Last Golf
                                </a>
                            </span>
                        </p>
                    </div>

                    <a href = #_intro>
                        <h2 class = 'h2 top-huge bottom-big' id = intro>Introduction</h2>
                    </a>
                    <div class = 'text shift'>
                        <p class = spaced>
                            Code golfing - you might have heard the term before.
                            If you haven't, then I'll clarify that we're talking
                            about a different kind of golf. "Code Golfing" is
                            the art of condensing a code program into the
                            smallest possible space. Code programs have the
                            potential to be massive, but when you golf them
                            you are - in effect - guiding that golf ball into
                            the hole. You're aiming for the perfect, most concise
                            combination of letters to create a functional but
                            extremely compact code program.
                        </p>

                        <p class = spaced>
                            The smallest unit of memory is a bit. A single letter
                            is made of 8 bits, which is called a byte. One day,
                            a programmer said to another programmer: "The goal
                            is, one thousand bytes to make a game." And that's
                            code golfing.
                        </p>

                        <p class = spaced>
                            To explain how small a 1k game really is, let's
                            use the example of the standard iPhone. At the
                            time of writing, it has the capacity to store
                            about 256 gigabytes of data. If every game in
                            the world only took up one kilobyte of memory,
                            you would potentially be able to store 1,000,000
                            of them on your iPhone alone. Here's a zoom-out of
                            how many games that would be.
                        </p>
                    </div>

                    <iframe class = 'demo-frame top bottom' src = /assets/platform-game-in-1k-1.html></iframe>

                    <div class = 'text shift'>
                        <p class = spaced>
                            I'd struggle to understand anyone actually <i>wanting</i>
                            a million games on their iPhone, but that's beside the point.
                        </p>
                        <p class = spaced>
                            In the past, programmers had to be good at code
                            golfing because their computers didn't have as
                            much memory as they do now. Pretty much the only
                            reason why it still exists nowadays is because it
                            makes people "feel good". It's just something about
                            having a few of lines of code, and knowing it's the
                            basis for a complete, playable game - where every
                            letter and every symbol is part of the reason why
                            the game exists.
                        </p>
                    </div>

                    <a href = #_game>
                        <h2 class = 'h2 top-huge bottom-big' id = game>Coding the Game From Scratch</h2>
                    </a>
                    <div class = 'text shift'>
                        <p class = spaced>
                            Before and during the competition, I set the
                            challenge of making a decent platformer in the smallest
                            possible amount of bytes. The rest of this post will
                            explain the entire development of Splash Dash.
                        </p>

                        <a href = #_setup>
                            <h3 class = 'h3 top-big bottom-big' id = setup>Step 1. Setting Up</h3>
                        </a>

                        <p class = spaced>
                            We're going to start with an empty HTML file. That's
                            the language every website thinks in, so even if
                            we're want to write in JavaScript, we have to
                            initialise it with HTML.
                        </p>

                        <p class = spaced>
                            To start off, let's create a canvas and open
                            JavaScript. An HTML canvas, like the name
                            suggests, allows us to figuratively "draw" things
                            on the screen. In our case, we're going to draw
                            our game onto the canvas.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">canvas</span> <span style="color:var(--variable)">id</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span><span style="color:var(--operator)">>&lt;/</span><span style="color:var(--variable)">canvas</span><span style="color:var(--operator)">></span> <span style="color:var(--comment)">// Make a canvas</span>
<span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">script</span><span style="color:var(--operator)">>&lt;/</span><span style="color:var(--variable)">script</span><span style="color:var(--operator)">></span> <span style="color:var(--comment)">// Initialise JavaScript</span></pre>
                        </div>

                        <p class = spaced>
                            The <span class = inline-code>&lt;script></span> tags allow us to start writing in
                            JavaScript. Let's create a function that runs every
                            single frame. This will allow us to progressively
                            render the game onto the canvas, instead of simply
                            drawing a static image.
                        </p>

                        <div class = 'demo-hint top-big bottom-big'>
                            <div class = demo-hint-icon>
                                <img src = /assets/bulb.svg>
                            </div>
                            <div class = 'text'>
                                <p class = spaced>
                                    To visualise this, consider how a flipbook works.
                                    It's made of a series of "frames," and by flipping
                                    the pages we can create an animation. Similarly,
                                    instead of drawing a single "frame" onto our canvas,
                                    we need to keep updating it to allow for an
                                    interactive game.
                                </p>
                            </div>
                        </div>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">script</span><span style="color:var(--operator)">></span>

<span style="color:var(--variable)">l</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">_</span><span style="color:var(--operator)">=>{</span> <span style="color:var(--comment)">// Initialise the update loop</span>
<span style="color:var(--function)">requestAnimationFrame</span>(<span style="color:var(--variable)">l</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Update the loop every frame</span>
<span style="color:var(--operator)">}</span>
<span style="color:var(--function)">l</span>(<span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Start running the loop when the game starts</span>

<span style="color:var(--operator)">&lt;/</span><span style="color:var(--variable)">script</span><span style="color:var(--operator)">></span></pre>
                        </div>

                        <p class = spaced>
                            In the code above, we create a function called <span class = inline-code>l</span>
                            (short for loop), we tell the computer to run this
                            function every frame by using <span class = inline-code>requestAnimationFrame()</span>,
                            and finally we begin running our funtion as soon as
                            the game starts.
                        </p>
                        <p class = spaced>
                            Inside the update loop, let's make the screen
                            responsive by setting the dimensions of the
                            canvas to the dimensions of the browser window.
                            We will also create the context. The context is
                            the figurative "paintbrush" that allows us to
                            draw things on the canvas.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--variable)">l</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">_</span><span style="color:var(--operator)">=>{</span>

 <span style="color:var(--comment)">// Get the dimensions of the canvas, while at the same time setting its dimensions</span>
 <span style="color:var(--variable)">W</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">width</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerWidth</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>
 <span style="color:var(--variable)">H</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">height</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerHeight</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>

 <span style="color:var(--function)">requestAnimationFrame</span>(<span style="color:var(--variable)">l</span><span style="color:var(--operator)">)</span>
<span style="color:var(--operator)">}</span>

<span style="color:var(--comment)">// Initialise the 2d context. Backticks save bytes by making brackets unnecessary</span>
<span style="color:var(--variable)">X</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">getContext</span><span style="color:var(--string)">`2d`</span>

<span style="color:var(--function)">l</span>(<span style="color:var(--operator)">)</span></pre>
                        </div>

                        <p class = spaced>
                            That's the set up done - we've created the canvas,
                            the paintbrush, and a function that runs every 60th
                            of a second. But we still just have a blank screen!
                            Let's add the player!
                        </p>

                        <a href = #_character>
                            <h3 class = 'h3 top-big bottom-big' id = character>Step 2. The Character</h3>
                        </a>

                        <p class = spaced>
                            In most cases, getting the main character sorted early
                            on is a good idea. Because I was trying to use as few
                            bytes as possible, I created a very simple box figure
                            with eyes and feet. The former had to be sacrificed
                            because of addition of the water simulation.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-character target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--variable)">l</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">_</span><span style="color:var(--operator)">=>{</span>
<span style="color:var(--variable)">W</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">width</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerWidth</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>
<span style="color:var(--variable)">H</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">height</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerHeight</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>

<span style="color:var(--comment)">// Get the average size of the webpage by adding the width and height together</span>
<span style="color:var(--variable)">z</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">)/</span><span style="color:var(--number)">25</span>

<span style="color:var(--comment)">// Make a function the draws rectangles</span>
<span style="color:var(--variable)">r</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,<span style="color:var(--variable)">s</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">X</span>.<span style="color:var(--function)">fillRect</span>(<span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span><span style="color:var(--operator)">)</span>

<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#034'</span> <span style="color:var(--comment)">// Body colour</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span>,.<span style="color:var(--number)">4</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Body</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Left foot</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">3</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Right foot</span>

<span style="color:var(--function)">requestAnimationFrame</span>(<span style="color:var(--variable)">l</span><span style="color:var(--operator)">)</span>
<span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">X</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">getContext</span><span style="color:var(--string)">`2d`</span>

<span style="color:var(--comment)">// Define the X and Y coordinates of the player</span>
<span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>

<span style="color:var(--function)">l</span>(<span style="color:var(--operator)">)</span></pre>
                        </div>

                        <p class = spaced>
                            There are quite a lot of additions in the code above,
                            so let's break it down. Before we run the update loop,
                            we define the x and y positions of the player, stored
                            as <span class = inline-code>d</span> and <span class = inline-code>e</span>.
                        </p>

                        <p class = spaced>
                            In the update loop, we create a simple function can
                            draw squares on the screen. Since every shape in the
                            game is a square and is drawn based on the player
                            position - which also happens to be the camera's -
                            the function only needs three arguments:
                            <span class = inline-code>x</span>,
                            <span class = inline-code>y</span>, and
                            <span class = inline-code>size</span>.
                            All drawing and offsetting is calculated in the function.
                        </p>

                        <p class = spaced>
                            After we create the function
                            <span class = inline-code>r(x, y, s)</span>, we can
                            draw the player with hardly any code. We set the fill
                            style of the player to determine its colour, and then
                            we simply draw the body and feet based on
                            <span class = inline-code>d</span> and
                            <span class = inline-code>e</span>.
                            I've repeated the relevant code below. Take a look
                            at the commented areas if you don't understand.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-character target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--comment)">// Make a function the draws rectangles</span>
<span style="color:var(--variable)">r</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,<span style="color:var(--variable)">s</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">X</span>.<span style="color:var(--function)">fillRect</span>(<span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span><span style="color:var(--operator)">)</span>

<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#034'</span> <span style="color:var(--comment)">// Body colour</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span>,.<span style="color:var(--number)">4</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Body</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Left foot</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">3</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Right foot</span></pre>
                        </div>

                        <div class = 'demo-img-container top-pad bottom-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-5.png>
                            </div>
                        </div>

                        <a href = #_blocks>
                            <h3 class = 'h3 top-big bottom-big' id = blocks>Step 3. Blocks and Gravity</h3>
                        </a>

                        <p class = spaced>
                            Now we have a basic character, we can start designing
                            the world it inhabits. Let's write a small patch of
                            code to create some ground.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-blocks target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--comment)">// Make a function the draws rectangles</span>
<span style="color:var(--variable)">r</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,<span style="color:var(--variable)">s</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">X</span>.<span style="color:var(--function)">fillRect</span>(<span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span><span style="color:var(--operator)">)</span>

<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#034'</span> <span style="color:var(--comment)">// Body colour</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span>,.<span style="color:var(--number)">4</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Body</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Left foot</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">3</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Right foot</span></pre>
                        </div>

                        <p class = spaced>
                            This is what it should look like so far.
                        </p>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-6.png>
                            </div>
                        </div>

                        <p class = spaced>
                            Things are taking shape! At the moment, the main
                            character is static, and can't move. The following
                            code snippet includes checks for arrow or WASD
                            keyboard inputs, which allows for player movement.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-control target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--variable)">l</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">_</span><span style="color:var(--operator)">=>{</span>
<span style="color:var(--variable)">W</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">width</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerWidth</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>
<span style="color:var(--variable)">H</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">height</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerHeight</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>

<span style="color:var(--comment)">// Move player</span>
<span style="color:var(--variable)">h</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">-=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>

<span style="color:var(--operator)">(</span>...<span style="color:var(--operator)">)</span>

<span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">X</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">getContext</span><span style="color:var(--string)">`2d`</span>

<span style="color:var(--comment)">// Define new variables</span>
<span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>

<span style="color:var(--comment)">// Detect key presses</span>
<span style="color:var(--variable)">P</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">e</span>,<span style="color:var(--variable)">b</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">38</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">87</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">39</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">68</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">37</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">65</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>
<span style="color:var(--variable)">onkeydown</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span>,<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">onkeyup</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>

<span style="color:var(--function)">l</span>(<span style="color:var(--operator)">)</span></pre>
                        </div>

                        <p class = spaced>
                            The above code adds three new variables: <span class = inline-code>g</span>,
                            the up key, which we will use shortly, <span class = inline-code>h</span>,
                            the left key, and <span class = inline-code>j</span>,
                            the right key. These numbers are <span class = inline-code>1</span> when
                            their corresponding key is pressed, but zero any
                            other time.
                        </p>

                        <p class = spaced>
                            Back in the update loop, we check whether the left
                            or right key is pressed, and then move the player's
                            x position accordingly. A very compact alternative
                            to writing if and else, is by using the <span class = inline-code>?</span>
                            and <span class = inline-code>:</span>
                            operators. In effect, <span class = inline-code>h?d-=.1:j?d+=.1:0</span>
                            does exactly the same thing as this:
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-control target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--keyword)">if</span> <span style="color:var(--operator)">(</span><span style="color:var(--variable)">h</span> <span style="color:var(--operator)">==</span> <span style="color:var(--number)">true</span><span style="color:var(--operator)">)</span> <span style="color:var(--operator)">{</span>
    <span style="color:var(--variable)">d</span> <span style="color:var(--operator)">-=</span> .<span style="color:var(--number)">1</span>
<span style="color:var(--operator)">}</span>

<span style="color:var(--keyword)">else</span> <span style="color:var(--keyword)">if</span> <span style="color:var(--operator)">(</span><span style="color:var(--variable)">j</span> <span style="color:var(--operator)">==</span> <span style="color:var(--number)">true</span><span style="color:var(--operator)">)</span> <span style="color:var(--operator)">{</span>
    <span style="color:var(--variable)">d</span> <span style="color:var(--operator)">+=</span> .<span style="color:var(--number)">1</span>
<span style="color:var(--operator)">}</span></pre>
                        </div>

                        <p class = spaced>
                            If you run the code so far, you'll realise that the
                            player can move left and right, but doesn't fall onto
                            the ground. This calls for the addition of gravity.
                            Here's the implementation of that.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-gravity target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--variable)">l</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">_</span><span style="color:var(--operator)">=>{</span>
<span style="color:var(--variable)">W</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">width</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerWidth</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>
<span style="color:var(--variable)">H</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">height</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerHeight</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>

<span style="color:var(--comment)">// Moved player based on gravity</span>
<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">007</span>
<span style="color:var(--variable)">h</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">-=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>

<span style="color:var(--operator)">(</span>...<span style="color:var(--operator)">)</span>

<span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">X</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">getContext</span><span style="color:var(--string)">`2d`</span>

<span style="color:var(--comment)">// Add a new number "f"</span>
<span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>

<span style="color:var(--variable)">P</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">e</span>,<span style="color:var(--variable)">b</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">38</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">87</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">39</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">68</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">37</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">65</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>
<span style="color:var(--variable)">onkeydown</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span>,<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">onkeyup</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>

<span style="color:var(--function)">l</span>(<span style="color:var(--operator)">)</span></pre>
                        </div>

                        <p class = spaced>
                            The new variable <span class = inline-code>f</span>
                            refers to the y velocity or "fall speed" of the player.
                            Every frame, we make this y velocity increase by a
                            small amount, and make the y position of the player
                            increase based in this velocity. This gives us a
                            simple but effective illusion of gravity.
                        </p>

                        <a href = #_collision>
                            <h3 class = 'h3 top-big bottom-big' id = collision>Step 4. Tiny Collision</h3>
                        </a>

                        <p class = spaced>
                            One of the most difficult parts of a platform game is
                            what is known as "Collision Response". Collision
                            response is the maths that stops the main character
                            from falling through the ground. So it's pretty
                            important. If you run the code above, you will
                            notice that the player has no interaction with
                            the orange blocks.
                        </p>

                        <p class = spaced>
                            The more edges you add to a collision response
                            calculation, the harder the maths becomes. For
                            example, let's say we have an infinite stretch
                            of perfectly flat ground. Let's visualise that.
                        </p>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-3.png>
                            </div>
                        </div>

                        <p class = spaced>
                            For the falling ball to have collision with the ground,
                            we would simply use the following calculation:
                            If the ball is too low, place it on the ground.
                        </p>
                        <p class = spaced>
                            But if we alter the line slightly, we are already
                            faced with two problems, both of which have been
                            circled in the image below.
                        </p>
                        <p class = spaced>
                            With our current calculation, if the ball rolls onto
                            the side of the jut, it will instantly jump to the
                            top. And if it hits a corner, we would expect it to
                            bounce off at a diagonal. So already we're having
                            to go into pretty advaced maths to figure out a
                            system that not only detects what part of the line
                            the ball is intersecting with, but also determining
                            a valid amount by which the ball should be moved away.
                        </p>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-4.png>
                            </div>
                        </div>

                        <p class = spaced>
                            In the end, I decided to go with the simplest approach,
                            although admittedly not a very accurate one. Here's a
                            summary of what the code needs to do.
                        </p>

                        <p class = spaced>
                            <span class = bullet-point>Remember the player's position from the last frame</span>
                            <span class = bullet-point>If the player is touching a block:</span>
                            <span class = 'bullet-point indent-1'>Move the player to his previous position</span>
                        </p>

                        <p class = spaced>
                            The issue with this approach is the fact that the
                            faster the player is moving the less accurate the
                            results will be. Where the player should have simply
                            been pushed to the side of the block, his position
                            is reset all the way back to where he was a frame
                            ago. But we're dealing with 1 kilobyte here, so it
                            doesn't matter.
                        </p>

                        <p class = spaced>
                            The code below makes the player have good collision
                            response with each block. Notice how we store the
                            previous position of the player by getting his
                            position before we move it.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-collision target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--variable)">W</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">width</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerWidth</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>
<span style="color:var(--variable)">H</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">height</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerHeight</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>

<span style="color:var(--comment)">// Get current player pos</span>
<span style="color:var(--variable)">D</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">d</span>
<span style="color:var(--variable)">E</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span>

<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">007</span>
<span style="color:var(--variable)">h</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">-=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>

<span style="color:var(--variable)">z</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">)/</span><span style="color:var(--number)">25</span>
<span style="color:var(--variable)">r</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,<span style="color:var(--variable)">s</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">X</span>.<span style="color:var(--function)">fillRect</span>(<span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span><span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Detect and resolve collision</span>
<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)%</span><span style="color:var(--number)">1</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">f</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">E</span>,<span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Ground</span>
<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>|<span style="color:var(--variable)">d</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">0</span>|<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">></span><span style="color:var(--number)">70</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">D</span>,<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">E</span><span style="color:var(--operator)">))</span> <span style="color:var(--comment)">// Wall and Ceiling</span>

<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#f80'</span>
<span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">70</span>;<span style="color:var(--variable)">x</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
    <span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">30</span>;<span style="color:var(--variable)">y</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>

<span style="color:var(--operator)">(</span>...<span style="color:var(--operator)">)</span>

<span style="color:var(--variable)">onkeydown</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span>,<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">onkeyup</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Create two new functions that return based on given block coordinates</span>
<span style="color:var(--variable)">a</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=>{</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">y</span>;<span style="color:var(--keyword)">return</span> <span style="color:var(--variable)">y</span><span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">A</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=></span><span style="color:var(--function)">a</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)></span><span style="color:var(--number)">0</span>
<span style="color:var(--function)">l</span>(<span style="color:var(--operator)">)</span></pre>
                        </div>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-8.png>
                            </div>
                        </div>

                        <p class = spaced>
                            If you run the code above you'll realise that the
                            player now collides with the ground. So what's
                            changed? At the top of the update loop, we get the
                            previous player position. Further down, we detect
                            collision by checking the cells around the player.
                            Before we get into how the collision actually works,
                            I'm going to take a minute to explain what our two
                            new functions do,
                            <span class = inline-code>a(x, y)</span> and
                            <span class = inline-code>A(x, y)</span>.
                        </p>

                        <p class = spaced>
                            The new <span class = inline-code>a(x, y)</span>
                            function we created rounds given
                            coordinates down to a whole number - that's what
                            the <span class = inline-code>~~</span> means -
                            and returns a value for the current
                            position. What does that mean?
                        </p>

                        <p class = spaced>
                            I'm going to ask you to think abstract for a moment.
                            Consider this: each block in our game has a size of
                            one. Let's say our player is at x coordinate
                            <span class = inline-code>3.5</span>
                            and y coordinate
                            <span class = inline-code>2.1</span>, and a block has its top-left
                            corner at x coordinate
                            <span class = inline-code>3</span> and y coordinate
                            <span class = inline-code>2</span>.
                        </p>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-7.png>
                            </div>
                        </div>

                        <p class = spaced>
                            To check if the player is colliding with the block,
                            we simply round the player's position down to the
                            nearest whole number. After that, all you need to
                            do is check if the player's rounded position matches
                            the block's position. This is a very simple way to
                            check collision with blocks that are ordered in a
                            grid. In fact, a similar technique was used in the
                            game <a class = link href = /games/ios-mission target = _blank>Io's Mission</a>.
                        </p>

                        <p class = spaced>
                            Anyway, back to the code. Let's review the two
                            functions again.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-collision target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--comment)">// Create two new functions that return based on given block coordinates</span>
<span style="color:var(--variable)">a</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=>{</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">y</span>;<span style="color:var(--keyword)">return</span> <span style="color:var(--variable)">y</span><span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">A</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=></span><span style="color:var(--function)">a</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)></span><span style="color:var(--number)">0</span></pre>
                        </div>

                        <p class = spaced>
                            The
                            <span class = inline-code>a(x, y)</span>
                            function is given a set of coordinates,
                            rounds the coordinates down to determine which block
                            we're dealing with, and then returns a number. This
                            "returned number" represents whether the original
                            coordinates are colliding with a block or not. If
                            they are, the function will return a number above
                            zero. If they're not, it will return a number that
                            is zero or under.
                        </p>

                        <p class = spaced>
                            Since our world is just a stretch of flat ground,
                            all we need to do is return the y position of the
                            block. That's what the function is doing where it
                            says return y.
                        </p>

                        <p class = spaced>
                            The first row of blocks - where the player starts -
                            has a y coordinate of
                            <span class = inline-code>0</span>, and we know there aren't any
                            blocks there. But for the remaining rows, since their
                            y position will always be greater than zero, the
                            computer will recognise them as blocks that need
                            to be collided with.
                        </p>

                        <p class = spaced>
                            The
                            <span class = inline-code>A(x, y)</span>
                            function detects if the coordinate should
                            be a block or not by simply checking if our
                            <span class = inline-code>a(x, y)</span>
                            function returns a number above than zero.
                        </p>

                        <p class = spaced>
                            That was the complicated part! Now we can get back
                            to the code in the update loop, where we actually
                            do the calculations for block collision.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-collision target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--comment)">// Get current player pos</span>
<span style="color:var(--variable)">D</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">d</span>
<span style="color:var(--variable)">E</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span>

<span style="color:var(--comment)">// Move the player</span>
<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">007</span>
<span style="color:var(--variable)">h</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">-=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>

<span style="color:var(--operator)">(</span>...<span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Detect and resolve collision</span>
<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)%</span><span style="color:var(--number)">1</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">f</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">E</span>,<span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Ground</span>
<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>|<span style="color:var(--variable)">d</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">0</span>|<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">></span><span style="color:var(--number)">70</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">D</span>,<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">E</span><span style="color:var(--operator)">))</span> <span style="color:var(--comment)">// Wall and Ceiling</span></pre>
                        </div>

                        <p class = spaced>
                            Let's take the first line, which detects if the player
                            is standing on the ground. I'm going to translate it
                            progressively, but if you don't understand, don't
                            worry! The break-down below is basically explaining
                            how the code detects when the player is standing on
                            the ground.
                        </p>

                        <div class = 'top-big-pad bottom-big-pad'>
                            <p class = spaced>
                                <span class = bullet-point>
                                    <span class = inline-code>A(d,e+.5)</span>
                                    If the bottom left cell just under the player is
                                    a solid block...
                                </span>
                            </p>

                            <p class = spaced>
                                <div class = 'demo-hint top bottom'>
                                    <div>
                                        Remember the player is only half the size of a block,
                                        so we use <span class = inline-code>.5</span>
                                        to access the block below him.
                                    </div>
                                </div>
                            </p>

                            <p class = spaced>
                                <span class = bullet-point>
                                    <span class = inline-code>&!A(d,e)</span> and the
                                    top left of the player is not <span class = inline-code>!</span> touching anything...
                                </span>
                            </p>

                            <p class = spaced>
                                <div class = 'demo-hint top bottom'>
                                    <div>
                                        Remember JavaScript works from the top left, so
                                        <span class = inline-code>d</span> and
                                        <span class = inline-code>e</span> refer to the top left of the player.
                                    </div>
                                </div>
                            </p>

                            <p class = spaced>
                                <span class = bullet-point>
                                    <span class = inline-code>|A(d+.5,e+.5)</span> or
                                    the bottom right cell just below the player is a
                                    solid block...
                                </span>
                            </p>

                            <p class = spaced>
                                <span class = bullet-point>
                                    <span class = inline-code>&!A(d+.5,e)</span> and
                                    the top right of the player is not touching
                                    anything...
                                </span>
                            </p>

                            <p class = spaced>
                                <span class = bullet-point>
                                    <span class = inline-code>&&(e+.5)%1&lt;f</span>
                                    Then - that's what the
                                    <span class = inline-code>&&</span>
                                    means - if the player's current y position plus
                                    his fall speed is enough to actually touch the
                                    blocks underneath him...
                                </span>
                            </p>

                            <p class = spaced>
                                <span class = bullet-point>
                                    <span class = inline-code>&&(e=E,f=0)</span>
                                    Then we finally know for sure that the player
                                    is on the ground. We revert his
                                    y position to what it was on the frame before,
                                    and we set his y velocity (or "fall speed") to
                                    zero, because - naturally - he's not falling anymore.
                                </span>
                            </p>
                        </div>

                        <p class = spaced>
                            I'm going to leave it up to you to break down the
                            second line if you want. If you're really stuck,
                            feel free to ask in the comment section at the end of
                            this page.
                        </p>

                        <a href = #_jumping>
                            <h3 class = 'h3 top-big bottom-big' id = jumping>Step 5. Jumping</h3>
                        </a>

                        <p class = spaced>
                            Well, this is quite an easy section - a little
                            intermission for you!
                        </p>

                        <p class = spaced>
                            Understandably, the player shouldn't be able to
                            jump from mid-air, but has to be standing on something
                            beforehand. Since we now know when the player is on
                            the ground, we can add this ability. Let's update
                            our code!
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-jump target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">canvas</span> <span style="color:var(--variable)">id</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span><span style="color:var(--operator)">>&lt;/</span><span style="color:var(--variable)">canvas</span><span style="color:var(--operator)">></span>
<span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">script</span><span style="color:var(--operator)">></span>
<span style="color:var(--variable)">l</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">T</span><span style="color:var(--operator)">=>{</span>
<span style="color:var(--variable)">W</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">width</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerWidth</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>
<span style="color:var(--variable)">H</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">height</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerHeight</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>

<span style="color:var(--variable)">D</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">d</span>
<span style="color:var(--variable)">E</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span>

<span style="color:var(--comment)">// Implement jump</span>
<span style="color:var(--variable)">g</span>&<span style="color:var(--variable)">v</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=-</span>.<span style="color:var(--number)">18</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">+=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">007</span>
<span style="color:var(--variable)">h</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">-=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>

<span style="color:var(--variable)">z</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">)/</span><span style="color:var(--number)">25</span>
<span style="color:var(--variable)">r</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,<span style="color:var(--variable)">s</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">X</span>.<span style="color:var(--function)">fillRect</span>(<span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span><span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Before collision, say the player is in the air</span>
<span style="color:var(--variable)">v</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>

<span style="color:var(--comment)">// Update collision</span>
<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)%</span><span style="color:var(--number)">1</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">f</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">E</span>,<span style="color:var(--variable)">v</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">1</span>,<span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span><span style="color:var(--operator)">)</span>
<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>|<span style="color:var(--variable)">d</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">0</span>|<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">></span><span style="color:var(--number)">70</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">D</span>,<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">E</span><span style="color:var(--operator)">))</span>

<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#f80'</span>
<span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">70</span>;<span style="color:var(--variable)">x</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
    <span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">30</span>;<span style="color:var(--variable)">y</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
        <span style="color:var(--keyword)">if</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">)</span><span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,.<span style="color:var(--number)">9</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Draw blocks</span>
    <span style="color:var(--operator)">}</span>
<span style="color:var(--operator)">}</span>

<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#034'</span> <span style="color:var(--comment)">// Body colour</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span>,.<span style="color:var(--number)">4</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Body</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Left foot</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">3</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Right foot</span>

<span style="color:var(--function)">requestAnimationFrame</span>(<span style="color:var(--variable)">l</span><span style="color:var(--operator)">)</span>
<span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">X</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">getContext</span><span style="color:var(--string)">`2d`</span>

<span style="color:var(--comment)">// Add a new number "v"</span>
<span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">v</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>

<span style="color:var(--variable)">P</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">e</span>,<span style="color:var(--variable)">b</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">38</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">87</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">39</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">68</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">37</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">65</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>
<span style="color:var(--variable)">onkeydown</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span>,<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">onkeyup</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>

<span style="color:var(--variable)">a</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=>{</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">y</span>;<span style="color:var(--keyword)">return</span> <span style="color:var(--variable)">y</span><span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">A</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=></span><span style="color:var(--function)">a</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)></span><span style="color:var(--number)">0</span>
<span style="color:var(--function)">l</span>(<span style="color:var(--operator)">)</span>
<span style="color:var(--operator)">&lt;/</span><span style="color:var(--variable)">script</span><span style="color:var(--operator)">></span></pre>
                        </div>

                        <p class = spaced>
                            The above code adds a new variable
                            <span class = inline-code>v</span>, which is a number
                            representing whether the player is on the ground or
                            not. If the player is on the ground and the up key
                            is pressed, we can change his y velocity.
                        </p>

                        <p class = spaced>
                            Notice that on the line where we detect ground
                            collision, we've added the code
                            <span class = inline-code>v=1</span>. Consequently,
                            <span class = inline-code>v</span> is 1 when the
                            player is on the ground, and zero any other time.
                        </p>

                        <p class = spaced>
                            While we're at it, let's make the jump slightly more
                            interesting by springing the character's body up a
                            little. This is not complicated, since we already
                            know the player's y velocity,
                            <span class = inline-code>f</span>.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-spring-jump target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#034'</span> <span style="color:var(--comment)">// Body colour</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">f</span>,.<span style="color:var(--number)">4</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Body</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Left foot</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">3</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Right foot</span></pre>
                        </div>

                        <a href = #_worlds>
                            <h3 class = 'h3 top-big bottom-big' id = worlds>Step 6. Making Worlds</h3>
                        </a>

                        <p class = spaced>
                            Out of everything in Splash Dash's the development,
                            I think making the levels was the most enjoyable part.
                            It was really amazing to see how it all came together
                            at the end.
                        </p>

                        <a href = #_formula>
                            <h4 class = 'h4 top-big bottom-big' id = formula>Part 1. The Basic Formula</h3>
                        </a>

                        <p class = spaced>
                            Naturally, being a project designed to be as small
                            as possible, manually designing each world wasn't
                            an option. I had to think of a formula that would
                            generate worlds that not only looked good, but would
                            also be fun and - more importantly - possible to play.
                        </p>

                        <p class = spaced>
                            The first stage was to make the formula. Before
                            we start, we need to make a small improvement to
                            the code that draws blocks on the screen. Instead
                            of writing
                            <span class = inline-code>if(y)r(x,y,.9)</span>,
                            we can now use our fancy
                            <span class = inline-code>A(x, y)</span>
                            function to make it more consistent.
                        </p>

                        <p class = spaced>
                            We've also learned that we can use the shorthand
                            <span class = inline-code>?</span> and
                            <span class = inline-code>:</span> operators instead of
                            <span class = inline-code>if</span>.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#f80'</span>
<span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">70</span>;<span style="color:var(--variable)">x</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
    <span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">30</span>;<span style="color:var(--variable)">y</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
        <span style="color:var(--function)">A</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)?</span><span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,.<span style="color:var(--number)">9</span><span style="color:var(--operator)">):</span><span style="color:var(--number)">0</span> <span style="color:var(--comment)">// Draw blocks</span>
    <span style="color:var(--operator)">}</span>
<span style="color:var(--operator)">}</span></pre>
                        </div>

                        <p class = spaced>
                            I fiddled around for some time getting the
                            formula right, but it still felt like a fluke when
                            I finally got a good one - sometimes trial and error
                            is the only option! After a while, I stumbled upon
                            the code shown below. I've edited the
                            <span class = inline-code>a(x, y)</span>
                            function because that's the thing that says whether
                            a given coordinate should be a block or not.
                        </p>

                        <p class = spaced>
                            If we want to generate worlds, we just distort these
                            coordinates so that the returned number gives us a
                            nice looking surface.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-surface target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code>

<span style="color:var(--variable)">a</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=>{</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">x</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">y</span>;<span style="color:var(--keyword)">return</span> <span style="color:var(--operator)">(</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">y</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">*</span><span style="color:var(--number)">9</span><span style="color:var(--operator)">)*</span><span style="color:var(--number)">6</span><span style="color:var(--operator)">)+</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">15</span><span style="color:var(--operator)">}</span>


</pre>
                        </div>

                        <p class = spaced>
                            Further up un our update loop, we can also give
                            these blocks more natural colours.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-color target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">70</span>;<span style="color:var(--variable)">x</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
    <span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">30</span>;<span style="color:var(--variable)">y</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
        <span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#'</span><span style="color:var(--operator)">+</span>~<span style="color:var(--operator)">(</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">x</span><span style="color:var(--operator)">)*</span><span style="color:var(--number)">5</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">543</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Random number representing hexadecimal values</span>
        <span style="color:var(--function)">A</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)?</span><span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,.<span style="color:var(--number)">9</span><span style="color:var(--operator)">):</span><span style="color:var(--number)">0</span>
    <span style="color:var(--operator)">}</span>
<span style="color:var(--operator)">}</span></pre>
                        </div>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-9.png>
                            </div>
                        </div>

                        <p class = spaced>
                            It's not looking too bad! I thought the generation
                            formula was completely sorted at this point, but I
                            later realised it needed some tweaking. Let's not
                            worry about that for now though, and push ahead
                            with adding some coins!
                        </p>

                        <a href = #_coins>
                            <h4 class = 'h4 top-big bottom-big' id = coins>Part 2. Adding Coins</h3>
                        </a>

                        <p class = spaced>
                            Let's first of all get these coins on the screen,
                            and then we can think about how the player collects
                            them.
                        </p>

                        <p class = spaced>
                            We can use our function
                            <span class = inline-code>a(x, y)</span>
                            to decide whether a coin should be placed on a
                            block or not.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-coins target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">70</span>;<span style="color:var(--variable)">x</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
    <span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">30</span>;<span style="color:var(--variable)">y</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
        <span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#'</span><span style="color:var(--operator)">+</span>~<span style="color:var(--operator)">(</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">x</span><span style="color:var(--operator)">)*</span><span style="color:var(--number)">5</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">543</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Random number representing hexadecimal values</span>
        <span style="color:var(--function)">A</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)?</span><span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,.<span style="color:var(--number)">9</span><span style="color:var(--operator)">):</span><span style="color:var(--number)">0</span>
    <span style="color:var(--operator)">}</span>
<span style="color:var(--operator)">}</span></pre>
                        </div>

                        <p class = spaced>
                            Well, they look a bit like coins, so that should be
                            enough for now.
                        </p>

                        <p class = spaced>
                            In the code above, we added a check to decide
                            whether a coin should be placed or not. Do you
                            remember earlier, we checked if a block should be
                            placed if our function
                            <span class = inline-code>a(x, y)</span> returned a number
                            that was greater than zero? In a similar way,
                            the code above checks if a coin should be placed
                            if the returned number is greater than minus one.
                            We make sure coins are never placed inside blocks
                            by putting it after the
                            <span class = inline-code>:</span> operator, which in this
                            case means
                            <span class = inline-code>else</span>. In effect,
                            the code above is doing this:
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--keyword)">if</span> <span style="color:var(--operator)">(</span><span style="color:var(--variable)">number</span> <span style="color:var(--operator)">></span> <span style="color:var(--number)">0</span><span style="color:var(--operator)">)</span>
    <span style="color:var(--comment)">// Draw block</span>

<span style="color:var(--keyword)">else</span> <span style="color:var(--keyword)">if</span> <span style="color:var(--operator)">(</span><span style="color:var(--variable)">number</span> <span style="color:var(--operator)">></span> <span style="color:var(--operator)">-</span><span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
    <span style="color:var(--comment)">// Draw coin</span></pre>
                        </div>

                        <p class = spaced>
                            Finally, to prevent coins from being created too low
                            down, we added &y&lt;17, which ensures that coins
                            are never created after the 16th row.
                        </p>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-10.png>
                            </div>
                        </div>

                        <p class = spaced>
                            Unlike a lot of features in this game, coins have to
                            be stored. That means, where all the blocks in the
                            world are solely calculated <b>based on their position</b>,
                            the thing that decides if a coins exists is <b>based on
                            whether the player has collected it</b> or not.
                        </p>

                        <p class = spaced>
                            Because of this, we need to create our first array -
                            or "list" - that allows us to keep track of all the
                            coins that the player has touched.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">v</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>

<span style="color:var(--comment)">// Create an array to store collected coins</span>
<span style="color:var(--variable)">k</span><span style="color:var(--operator)">=</span>[]

<span style="color:var(--variable)">P</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">e</span>,<span style="color:var(--variable)">b</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">38</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">87</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">39</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">68</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">37</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">65</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>
<span style="color:var(--variable)">onkeydown</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span>,<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">onkeyup</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span></pre>
                        </div>

                        <p class = spaced>
                            Just after we resolve block collision, we can check
                            if the player is touching a coin. This check uses
                            the same method we used to draw the coins on the
                            screen. Further down the code, we can add the line
                            <span class = inline-code>&!k[x*y]</span>
                            to make sure collected coins aren't drawn.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-collect-coins target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)%</span><span style="color:var(--number)">1</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">f</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">E</span>,<span style="color:var(--variable)">v</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">1</span>,<span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Ground</span>
<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>|<span style="color:var(--variable)">d</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">0</span>|<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">></span><span style="color:var(--number)">70</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">D</span>,<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">E</span><span style="color:var(--operator)">))</span> <span style="color:var(--comment)">// Wall and Ceiling</span>

<span style="color:var(--comment)">// Coin collision</span>
<span style="color:var(--variable)">e</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">17</span>&<span style="color:var(--function)">a</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)>-</span><span style="color:var(--number)">1</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">k</span>[~~<span style="color:var(--variable)">d</span><span style="color:var(--operator)">*</span>~~<span style="color:var(--variable)">e</span>]<span style="color:var(--operator)">=</span><span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>

<span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">70</span>;<span style="color:var(--variable)">x</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
    <span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">30</span>;<span style="color:var(--variable)">y</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
        <span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#'</span><span style="color:var(--operator)">+</span>~<span style="color:var(--operator)">(</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">x</span><span style="color:var(--operator)">)*</span><span style="color:var(--number)">5</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">543</span><span style="color:var(--operator)">)</span>

        <span style="color:var(--comment)">// Only draw coin if it hasn't been collected</span>
        <span style="color:var(--function)">A</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)?</span><span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,.<span style="color:var(--number)">9</span><span style="color:var(--operator)">):</span><span style="color:var(--function)">a</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)>-</span><span style="color:var(--number)">1</span>&<span style="color:var(--variable)">y</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">17</span>&!<span style="color:var(--variable)">k</span>[<span style="color:var(--variable)">x</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">y</span>]&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#bb0'</span>,<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">3</span><span style="color:var(--operator)">))</span>
    <span style="color:var(--operator)">}</span>
<span style="color:var(--operator)">}</span></pre>
                        </div>

                        <p class = spaced>
                            While we're at it, let's make the coins float by
                            animating their y position...
                        </p>

                        <div class = 'code-holder top bottom-big-pad'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-floating-coins target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">70</span>;<span style="color:var(--variable)">x</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
    <span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">30</span>;<span style="color:var(--variable)">y</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span>
        <span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#'</span><span style="color:var(--operator)">+</span>~<span style="color:var(--operator)">(</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">x</span><span style="color:var(--operator)">)*</span><span style="color:var(--number)">5</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">543</span><span style="color:var(--operator)">)</span>
        <span style="color:var(--function)">A</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)?</span><span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,.<span style="color:var(--number)">9</span><span style="color:var(--operator)">):</span><span style="color:var(--function)">a</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)>-</span><span style="color:var(--number)">1</span>&<span style="color:var(--variable)">y</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">17</span>&!<span style="color:var(--variable)">k</span>[<span style="color:var(--variable)">x</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">y</span>]&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#bb0'</span>,<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">_</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">50</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">)*</span>.<span style="color:var(--number)">1</span>,.<span style="color:var(--number)">3</span><span style="color:var(--operator)">))</span>
    <span style="color:var(--operator)">}</span>
<span style="color:var(--operator)">}</span></pre>
                        </div>

                        <a href = #_water>
                            <h4 class = 'h4 top-big bottom-big' id = water>Part 3. Simulating Water</h3>
                        </a>

                        <p class = spaced>
                            Now for the water simulation! The technique used in the
                            game is probably the simplest form of water possible.
                            It involves having a row of "points," which can move up
                            and down based on their neighbour's y position.
                        </p>

                        <p class = spaced>
                            The fundamental structure of this kind of water
                            simulation is that all points are trying to reach
                            equilibrium. If an adjacent point is higher or
                            lower than the first one, the first point will
                            speed up or slow down accordingly to balance
                            with its neighbour.
                        </p>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-11.png>
                            </div>
                        </div>

                        <p class = spaced>
                            Before we implement that, let's see what it looks
                            like to add some flat water to the world.
                        </p>

                        <div class = 'code-holder top bottom-big-pad'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-basic-water target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">3</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Make a blue rectangle</span>
<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#0698'</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--number)">0</span>,<span style="color:var(--number)">13</span>,<span style="color:var(--number)">70</span><span style="color:var(--operator)">)</span>

<span style="color:var(--function)">requestAnimationFrame</span>(<span style="color:var(--variable)">l</span><span style="color:var(--operator)">)</span></pre>
                        </div>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-12.png>
                            </div>
                        </div>

                        <p class = spaced>
                            The bulk of the water looks okay, but the surface needs
                            to be more fluid. In the code above, we simply created
                            a transparent blue rectangle and rendered it on top of
                            everything. Let's implement the method we described in
                            the outset of this section.
                        </p>

                        <div class = 'code-holder top bottom-big-pad'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-water target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">3</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>

<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#0698'</span>

<span style="color:var(--comment)">// Run through all 317 water points and draw them on the screen</span>
<span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">634</span>;<span style="color:var(--variable)">i</span><span style="color:var(--operator)">-=</span><span style="color:var(--number)">2</span>;<span style="color:var(--variable)">X</span>.<span style="color:var(--function)">lineTo</span>(<span style="color:var(--operator)">(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">9</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--operator)">(</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span>]<span style="color:var(--operator)">+</span><span style="color:var(--number)">13</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span><span style="color:var(--operator)">)){</span>
<span style="color:var(--comment)">// A the start of the program, fill the array with numbers</span>
<span style="color:var(--keyword)">if</span><span style="color:var(--operator)">(</span>!<span style="color:var(--variable)">_</span><span style="color:var(--operator)">)</span><span style="color:var(--variable)">J</span>.<span style="color:var(--function)">push</span>(<span style="color:var(--number)">0</span>,<span style="color:var(--number)">0</span><span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Calculate the water simulation and detect player collision</span>
<span style="color:var(--keyword)">else</span><span style="color:var(--operator)">{</span>
<span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span>]<span style="color:var(--operator)">+=</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">*(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">></span><span style="color:var(--number)">3</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">+=(</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">+</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">_</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">)*</span>.<span style="color:var(--number)">02</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">)/</span><span style="color:var(--number)">2</span>
~<span style="color:var(--variable)">d</span><span style="color:var(--operator)">==</span>~<span style="color:var(--operator)">(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">9</span><span style="color:var(--operator)">)</span>&<span style="color:var(--variable)">e</span><span style="color:var(--operator)">></span><span style="color:var(--number)">12</span>&<span style="color:var(--variable)">e</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">14</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">+=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">4</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">*=</span>.<span style="color:var(--number)">97</span><span style="color:var(--operator)">*(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">630</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">-=</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span>]<span style="color:var(--operator)">/</span><span style="color:var(--number)">25</span>
<span style="color:var(--operator)">}}</span>

<span style="color:var(--function)">r</span>(<span style="color:var(--number)">0</span>,<span style="color:var(--number)">13</span>,<span style="color:var(--number)">70</span><span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Draw the water surface on the screen</span>
<span style="color:var(--variable)">X</span>.<span style="color:var(--function)">fill</span>(<span style="color:var(--operator)">)</span>

<span style="color:var(--function)">requestAnimationFrame</span>(<span style="color:var(--variable)">l</span><span style="color:var(--operator)">)</span>
<span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">X</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">getContext</span><span style="color:var(--string)">`2d`</span>

<span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">v</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>

<span style="color:var(--comment)">// Create an array called J to store the water</span>
<span style="color:var(--variable)">k</span><span style="color:var(--operator)">=</span>[<span style="color:var(--variable)">J</span><span style="color:var(--operator)">=</span>[]]</pre>
                        </div>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-13.png>
                            </div>
                        </div>

                        <p class = spaced>
                            It works, but what's the code doing? First, we create
                            a new array -
                            <span class = inline-code>J</span> -
                            to store all the points for the surface of the water.
                            In the update loop, we run a process that starts at
                            634 and counts down by two after every run. What does
                            that mean?
                        </p>

                        <p class = spaced>
                            The method used in the code is known as a "for-loop".
                            A for-loop can allow you to run a process multiple
                            times, with a number representing which "run" it's
                            on. In our case, we started our number at 634 and
                            counted down in twos until we reached zero.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code>

<span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">634</span>;<span style="color:var(--variable)">i</span><span style="color:var(--operator)">-=</span><span style="color:var(--number)">2</span>;<span style="color:var(--operator)">)</span>
                            </pre>
                        </div>

                        <p class = spaced>
                            Then we checked how long the game had been running
                            for. The code said that if the game was on the first
                            frame, fill our water array with points. Otherwise,
                            calculate and render the water on the screen.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--keyword)">if</span><span style="color:var(--operator)">(</span>!<span style="color:var(--variable)">_</span><span style="color:var(--operator)">)</span><span style="color:var(--variable)">J</span>.<span style="color:var(--function)">push</span>(<span style="color:var(--number)">0</span>,<span style="color:var(--number)">0</span><span style="color:var(--operator)">)</span>
<span style="color:var(--keyword)">else</span><span style="color:var(--operator)">{</span>
<span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span>]<span style="color:var(--operator)">+=</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">*(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">></span><span style="color:var(--number)">3</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">+=(</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">+</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">_</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">)*</span>.<span style="color:var(--number)">02</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">)/</span><span style="color:var(--number)">2</span>
~<span style="color:var(--variable)">d</span><span style="color:var(--operator)">==</span>~<span style="color:var(--operator)">(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">9</span><span style="color:var(--operator)">)</span>&<span style="color:var(--variable)">e</span><span style="color:var(--operator)">></span><span style="color:var(--number)">12</span>&<span style="color:var(--variable)">e</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">14</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">+=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">4</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">*=</span>.<span style="color:var(--number)">97</span><span style="color:var(--operator)">*(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">630</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">-=</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span>]<span style="color:var(--operator)">/</span><span style="color:var(--number)">25</span>
<span style="color:var(--operator)">}</span></pre>
                        </div>

                        <p class = spaced>
                            Let's break that down.
                        </p>

                        <div class = 'boxed bottom'>
                            <p class = spaced>
                                <span class = inline-code>J[i]+=J[i+1]*(i>3)</span>
                            </p>
                            <p class = spaced>
                                Basically, our array stores two values for each
                                water point: the y position and the speed.
                                <span class = inline-code>J[i]</span>
                                is accessing the relevant y position by getting
                                array's contents at the current "index" of the
                                for-loop.
                                <span class = inline-code>+=J[i+1]</span>
                                makes the y position increase
                                or decrease based on its speed. The last part,
                                <span class = inline-code>*(i>3)</span>,
                                is trivial, but solves a small glitch at the
                                side of the world.
                            </p>
                        </div>

                        <div class = 'boxed bottom'>
                            <p class = spaced>
                                <span class = inline-code>J[i+1]+=(J[i-1]+Math.sin(_*J[i+1])*.02-J[i+1])/2</span>
                            </p>
                            <p class = spaced>
                                The code above manipulates the point's speed.
                                By default, the speed is zero, which means the
                                water will be perfectly flat and static. When
                                the speed changes, the y position of the point
                                will also change, as we described earlier.
                            </p>
                            <p class = spaced>
                                I won't go into too much detail, but essentially
                                this piece of code just adds a bit of randomisation
                                to the surface of the water. If you played the
                                game, did you notice that the water seemed to
                                ripple on its own? This is the code that's
                                making that happen.
                            </p>
                        </div>

                        <div class = 'boxed bottom'>
                            <p class = spaced>
                                <span class = inline-code>~d==~(i/9)&e>12&e&lt;14?J[i+1]+=f/4:J[i+1]*=.97*(i&lt;630)</span>
                            </p>
                            <p class = spaced>
                                This line of code deals with player collision and
                                water damping. Let's go into that with a bit
                                more detail.
                            </p>

                            <p class = spaced>
                                <span class = inline-code>~d==~(i/9)</span>
                                This code checks if the x position of the player -
                                <span class = inline-code>d</span> - is in a
                                similar place to the given water segment. Remember
                                <span class = inline-code>i</span> is our for-loop's run count,
                                so we can use it to get the x position of the water.
                                Since all water segments are laid out in a row
                                with an equal distance between them, it's easy
                                to check if the player is in line with one of them.
                            </p>

                            <div class = 'demo-hint top-big bottom-big'>
                                <div class = demo-hint-icon>
                                    <img src = /assets/bulb.svg>
                                </div>
                                <div class = 'text'>
                                    <p class = spaced>
                                        The <span class = inline-code>i/9</span>
                                        is a quick way of getting the
                                        relative position of the water segment.
                                        The width of the whole world in our game
                                        is 70 blocks. The amount of water segments
                                        in our world is 634. So we do the
                                        calculation 634 &divide; 70, and we get something
                                        very close to 9. This means that roughly
                                        9 water segments can fit inside a block.
                                        Since our player's position is based on
                                        the size of a block,
                                        <span class = inline-code>i/9</span> gives us a good
                                        approximation.
                                    </p>
                                </div>
                            </div>

                            <p class = spaced>
                                <span class = inline-code>&e>12&e&lt;14?</span>
                                Here we check if the player's y
                                position is near the sea level. We're not
                                bothering to do a proper collision check because
                                the water will always be hanging around the 13th
                                row of blocks, give or take a few. At the end of
                                this piece of code we end the if statement with a
                                <span class = inline-code>?</span>,
                                because we now have enough information to
                                conclude that the player has collided with the water.
                            </p>

                            <p class = spaced>
                                <span class = inline-code>J[i+1]+=f/4</span>
                                This code makes the water segment's y velocity
                                match the y velocity of the player. This means
                                that if the player is falling, the water will
                                splash downwards, but if he's jumping out of
                                the water, it'll go up instead.
                            </p>

                            <p class = spaced>
                                <span class = inline-code>:J[i+1]*=.97*(i&lt;630)</span>
                                You can probably figure
                                out this line. Without it, any movement in the
                                water would repeat forever with equal force.
                                However, because we constantly decrease the
                                water's speed every frame, the surface can
                                gradually calm down.
                            </p>
                        </div>

                        <div class = 'boxed bottom'>
                            <p class = spaced>
                                <span class = inline-code>J[i+1]-=J[i]/25</span>
                            </p>

                            <p class = spaced>
                                Even though it may look simple, this last line
                                is a rather important one. It's the thing that
                                keeps the water hanging around the same place.
                                If the y position of the water is too low, the
                                speed of the water tries increasingly hard to
                                push it up. When the water segment is too high,
                                the speed pushes it down.
                            </p>
                        </div>

                        <p class = spaced>
                            The implementation of a water simulation may seem
                            complicated, but as long as you keep reminding yourself
                            of the basic principle that water is always trying to
                            reach equilibrium, it should be quite easy to
                            implement in code.
                        </p>

                        <p class = spaced>
                            One line I didn't discuss was the actual drawing of
                            the water. Let's take a minute to understand that.
                            It's quite simple.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code>

<span style="color:var(--variable)">X</span>.<span style="color:var(--function)">lineTo</span>(<span style="color:var(--operator)">(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">9</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--operator)">(</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span>]<span style="color:var(--operator)">+</span><span style="color:var(--number)">13</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span><span style="color:var(--operator)">)</span>

</pre>
                        </div>

                        <p class = spaced>
                            The code might look a bit overwhelming, but a large
                            part of it is changing the coordinates based on the
                            camera position and scale. Because none of that is
                            very helpful for explanatory purposes, I'm going to
                            simplify the above code to this:
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code>

<span style="color:var(--function)">lineTo</span>(<span style="color:var(--variable)">i</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">9</span>,<span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span>]<span style="color:var(--operator)">+</span><span style="color:var(--number)">13</span><span style="color:var(--operator)">)</span>

</pre>
                        </div>

                        <p class = spaced>
                            Well, that's a bit easier to understand! The x
                            position of our water segment is
                            <span class = inline-code>i/9</span> to ensure
                            that each block holds about nine segments. The code
                            <span class = inline-code>J[i]+13</span> positions
                            the water based on its stored y
                            position, plus the number 13 to prevent the sea level
                            from being too high up.
                        </p>

                        <a href = #_levels>
                            <h4 class = 'h4 top-big bottom-big' id = levels>Part 4. Playable Levels</h3>
                        </a>

                        <p class = spaced>
                            At the moment, the player is just navigating around
                            a single world. To add multiple worlds, we'll first
                            need to check if the player has collected all the
                            coins and then increase the seed. We'll go into
                            that a bit more shortly.
                        </p>

                        <p class = spaced>
                            Here is the code for checking if all the coins have
                            been collected. See if you can figure out how it works.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--comment)">// Make a number to count the remaining coins</span>
<span style="color:var(--variable)">K</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>

<span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">70</span>;<span style="color:var(--variable)">x</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span> <span style="color:var(--comment)">// Start at 70 and count down</span>
    <span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">30</span>;<span style="color:var(--variable)">y</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span> <span style="color:var(--comment)">// Start at 30 and count down</span>
        <span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#'</span><span style="color:var(--operator)">+</span>~<span style="color:var(--operator)">(</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">x</span><span style="color:var(--operator)">)*</span><span style="color:var(--number)">5</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">543</span><span style="color:var(--operator)">)</span>

        <span style="color:var(--comment)">// Increase the coin count</span>
        <span style="color:var(--function)">A</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)?</span><span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,.<span style="color:var(--number)">9</span><span style="color:var(--operator)">):</span><span style="color:var(--function)">a</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)>-</span><span style="color:var(--number)">1</span>&<span style="color:var(--variable)">y</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">17</span>&!<span style="color:var(--variable)">k</span>[<span style="color:var(--variable)">x</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">y</span>]&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#bb0'</span>,<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">_</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">50</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">K</span><span style="color:var(--operator)">++)*</span>.<span style="color:var(--number)">1</span>,.<span style="color:var(--number)">3</span><span style="color:var(--operator)">))</span>
    <span style="color:var(--operator)">}</span>
<span style="color:var(--operator)">}</span>

<span style="color:var(--operator)">(</span>...<span style="color:var(--operator)">)</span>


<span style="color:var(--comment)">// Detect when there are no more coins left and reset the player's position</span>
!<span style="color:var(--variable)">K</span><span style="color:var(--operator)">?(</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">1</span><span style="color:var(--operator)">):</span><span style="color:var(--number)">0</span>

<span style="color:var(--function)">requestAnimationFrame</span>(<span style="color:var(--variable)">l</span><span style="color:var(--operator)">)</span>
<span style="color:var(--operator)">}</span>
                            </pre>
                        </div>

                        <p class = spaced>
                            In the code above, we run a check to see if there are
                            any remaining coins. We do this by adding to a number
                            when a coin is drawn. If the number is zero, we know
                            there aren't any more coins. To save a few bytes, we
                            incremented this number by inserting
                            <span class = inline-code>+K++</span> to the code
                            that makes the coins float.
                        </p>

                        <p class = spaced>
                            Now for generating the next level. A key feature of
                            generating levels is using a seed. A seed is a code
                            for a randomly generated world - depending on what
                            this "seed" is set to, the resulting world will be
                            different.
                        </p>

                        <p class = spaced>
                            Let's add a seed to our level generation formula so
                            that we can generate different worlds every time.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-new-level target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--comment)">// Increase the seed and clear the collected coins array</span>
!<span style="color:var(--variable)">K</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">k</span><span style="color:var(--operator)">=</span>[<span style="color:var(--variable)">Q</span><span style="color:var(--operator)">+=</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>

<span style="color:var(--function)">requestAnimationFrame</span>(<span style="color:var(--variable)">l</span><span style="color:var(--operator)">)</span>
<span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">X</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">getContext</span><span style="color:var(--string)">`2d`</span>

<span style="color:var(--comment)">// Create the world seed called "Q"</span>
<span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">v</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">Q</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>

<span style="color:var(--variable)">k</span><span style="color:var(--operator)">=</span>[<span style="color:var(--variable)">J</span><span style="color:var(--operator)">=</span>[]]

<span style="color:var(--variable)">P</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">e</span>,<span style="color:var(--variable)">b</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">38</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">87</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">39</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">68</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">37</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">65</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>
<span style="color:var(--variable)">onkeydown</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span>,<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">onkeyup</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Apply seed to level</span>
<span style="color:var(--variable)">a</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=>{</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">x</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">y</span>;<span style="color:var(--keyword)">return</span> <span style="color:var(--operator)">(</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">y</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">*</span><span style="color:var(--number)">9</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">Q</span><span style="color:var(--operator)">)*</span><span style="color:var(--number)">6</span><span style="color:var(--operator)">)+</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">15</span><span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">A</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=></span><span style="color:var(--function)">a</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)></span><span style="color:var(--number)">0</span>

<span style="color:var(--function)">l</span>(<span style="color:var(--operator)">)</span></pre>
                        </div>

                        <p class = spaced>
                            Before we run the update loop, we define a new
                            variable to represent the seed, called Q. In our
                            <span class = inline-code>a(x, y)</span> function,
                            we add this "seed" to the formula.
                        </p>

                        <p class = spaced>
                            Further up in our update loop, we clear the collected
                            coins array and increment our seed by 1. This will
                            make the level automatically switch to a different
                            world, as our
                            <span class = inline-code>a(x, y)</span>
                            function will now return different numbers.
                        </p>

                        <p class = spaced>
                            The program not changes worlds! Since our game needs
                            a few levels, I've taken a screenshot of the first
                            three levels for us to analyse. This is the first
                            level, where the seed is zero.
                        </p>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-14.png>
                            </div>
                        </div>

                        <p class = spaced>
                            The seed is incremented by one to give us the next level.
                            It looks pretty good!
                        </p>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-16.png>
                            </div>
                        </div>

                        <p class = spaced>
                            Annoyingly, the last level - where the seed is two -
                            has given us some problems. As the screenshot shows,
                            we have found our first unreachable coin that is
                            completely trapped under the rocks. Further along
                            the level there's also a very deep hole that's
                            impossible to jump out of.
                        </p>

                        <p class = spaced>
                            As you can imagine, this was rather frustrating for
                            me during the creation of the game. I didn't really
                            want to remake my level generation formula, because
                            I was really happy with how it looked. The only other
                            option was to find a seed that actually made a playable
                            level - and to make a formula that could get to that seed.
                            After a lot of testing, I realised the next valid level
                            was on seed 15.
                        </p>

                        <p class = spaced>
                            Fortunately, because levels one and two were completely
                            valid anyway, it didn't take long to find a simple
                            formula that worked.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code>

<span style="color:var(--variable)">Q</span> <span style="color:var(--operator)">=</span> <span style="color:var(--operator)">(</span><span style="color:var(--variable)">Q</span> <span style="color:var(--operator)">*</span> <span style="color:var(--number)">14</span><span style="color:var(--operator)">)</span> <span style="color:var(--operator)">+</span> <span style="color:var(--number)">1</span>

</pre>
                        </div>

                        <p class = spaced>
                            At the very start of the game, the seed is set to
                            zero, giving us the first level. Once the level's
                            finished, the above equation is run.
                            <span class = inline-code>Q = (0 * 14) + 1</span>
                            gives us the number 1, which is our next valid seed.
                            Once the player has collected all the coins, running
                            the formula again like
                            <span class = inline-code>Q = (1 * 14) + 1</span>
                            will give us a grand total of 15.
                        </p>

                        <p class = spaced>
                            The formula works, so let's implement that in code.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-new-level-improved target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--variable)">X</span>.<span style="color:var(--function)">fill</span>(<span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Apply the formula by multiplying the seed and adding one every time</span>
!<span style="color:var(--variable)">K</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">k</span><span style="color:var(--operator)">=</span>[<span style="color:var(--variable)">Q</span><span style="color:var(--operator)">*=</span><span style="color:var(--number)">14</span>,<span style="color:var(--variable)">Q</span><span style="color:var(--operator)">+=</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>

<span style="color:var(--function)">requestAnimationFrame</span>(<span style="color:var(--variable)">l</span><span style="color:var(--operator)">)</span></pre>
                        </div>

                        <p class = spaced>
                            That was a lot of work! Fortunately we've now tackled
                            all the complicated parts of the game, leaving us the
                            easy job of making the worlds look nice and adding a
                            few final gameplay dynamics.
                        </p>

                        <a href = #_details>
                            <h4 class = 'h4 top-big bottom-big' id = details>Part 5. Final Details</h3>
                        </a>

                        <p class = spaced>
                            So far, we have created the character, added controls,
                            figured out some pretty good collision response, created
                            three fully-playable worlds and implemented a decent
                            water simulation. All we have left to do is just making
                            the worlds look a bit better and adding a level of
                            challenge to the game.
                        </p>

                        <p class = spaced>
                            For a start, let's make the blocks the right size.
                            We can do that by changing the line where we draw the
                            blocks from
                            <span class = inline-code>r(x,y,.9)</span> to
                            <span class = inline-code>r(x,y,1)</span>.
                        </p>

                        <p class = spaced>
                            We can also make a nice background by changing the
                            code like below. The code also includes changes to
                            the coins' colour, walls at the side of the level
                             and the addition of a temperature bar. See if you
                             can figure it out.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/platform-game-in-1k-final-details target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--variable)">l</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">_</span><span style="color:var(--operator)">=>{</span>
<span style="color:var(--variable)">W</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">width</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerWidth</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>
<span style="color:var(--variable)">H</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">height</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">innerHeight</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">16</span>

<span style="color:var(--variable)">D</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">d</span>
<span style="color:var(--variable)">E</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span>

<span style="color:var(--variable)">g</span>&<span style="color:var(--variable)">v</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=-</span>.<span style="color:var(--number)">18</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">+=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">007</span>
<span style="color:var(--variable)">h</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">-=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">+=</span>.<span style="color:var(--number)">1</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>
<span style="color:var(--variable)">z</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">)/</span><span style="color:var(--number)">25</span>

<span style="color:var(--variable)">r</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,<span style="color:var(--variable)">s</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">X</span>.<span style="color:var(--function)">fillRect</span>(<span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span>,<span style="color:var(--variable)">z</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">s</span><span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Draw two background shades</span>
<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">t</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--number)">0</span>,<span style="color:var(--number)">0</span>,<span style="color:var(--variable)">W</span><span style="color:var(--operator)">)</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">v</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>,<span style="color:var(--number)">9</span>,<span style="color:var(--variable)">W</span><span style="color:var(--operator)">)</span>

<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)%</span><span style="color:var(--number)">1</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">f</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">E</span>,<span style="color:var(--variable)">v</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">1</span>,<span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span><span style="color:var(--operator)">)</span> <span style="color:var(--comment)">// Ground</span>
<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">)</span>|<span style="color:var(--variable)">d</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">0</span>|<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span><span style="color:var(--operator)">></span><span style="color:var(--number)">70</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">D</span>,<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>|<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">5</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">E</span><span style="color:var(--operator)">))</span> <span style="color:var(--comment)">// Wall and Ceiling</span>

<span style="color:var(--variable)">e</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">17</span>&!<span style="color:var(--function)">A</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>&<span style="color:var(--function)">a</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)>-</span><span style="color:var(--number)">1</span>&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">k</span>[~~<span style="color:var(--variable)">d</span><span style="color:var(--operator)">*</span>~~<span style="color:var(--variable)">e</span>]<span style="color:var(--operator)">=</span><span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>

<span style="color:var(--variable)">K</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>
<span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">70</span>;<span style="color:var(--variable)">x</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span> <span style="color:var(--comment)">// Start at 70 and count down</span>
    <span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">30</span>;<span style="color:var(--variable)">y</span><span style="color:var(--operator)">--</span>;<span style="color:var(--operator)">){</span> <span style="color:var(--comment)">// Start at 30 and count down</span>
        <span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#'</span><span style="color:var(--operator)">+</span>~<span style="color:var(--operator)">(</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">x</span><span style="color:var(--operator)">)*</span><span style="color:var(--number)">5</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">543</span><span style="color:var(--operator)">)</span>
        <span style="color:var(--comment)">// Make the coins brighter</span>
        <span style="color:var(--function)">A</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)?</span><span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span>,.<span style="color:var(--number)">9</span><span style="color:var(--operator)">):</span><span style="color:var(--function)">a</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)>-</span><span style="color:var(--number)">1</span>&<span style="color:var(--variable)">y</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">17</span>&!<span style="color:var(--variable)">k</span>[<span style="color:var(--variable)">x</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">y</span>]&&<span style="color:var(--operator)">(</span><span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#ff0'</span>,<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">x</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">_</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">50</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">K</span><span style="color:var(--operator)">++)*</span>.<span style="color:var(--number)">1</span>,.<span style="color:var(--number)">3</span><span style="color:var(--operator)">))</span>
    <span style="color:var(--operator)">}</span>
<span style="color:var(--operator)">}</span>
<span style="color:var(--comment)">// Walls at the edge</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--operator)">-</span><span style="color:var(--variable)">W</span>,<span style="color:var(--number)">0</span>,<span style="color:var(--variable)">W</span><span style="color:var(--operator)">)</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--number)">70</span>,<span style="color:var(--number)">0</span>,<span style="color:var(--variable)">W</span><span style="color:var(--operator)">)</span>

<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#034'</span>
<span style="color:var(--comment)">// Draw the temperature bar</span>
<span style="color:var(--variable)">X</span>.<span style="color:var(--function)">fillRect</span>(<span style="color:var(--number)">0</span>,<span style="color:var(--number)">0</span>,<span style="color:var(--variable)">W</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">V</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">5e3</span>,<span style="color:var(--variable)">H</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">9</span><span style="color:var(--operator)">)</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">f</span>,.<span style="color:var(--number)">4</span><span style="color:var(--operator)">)</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--variable)">d</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">3</span>,<span style="color:var(--variable)">e</span><span style="color:var(--operator)">+</span>.<span style="color:var(--number)">4</span>,.<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>

<span style="color:var(--variable)">X</span>.<span style="color:var(--variable)">fillStyle</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#0698'</span>
<span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">634</span>;<span style="color:var(--variable)">i</span><span style="color:var(--operator)">-=</span><span style="color:var(--number)">2</span>;<span style="color:var(--variable)">X</span>.<span style="color:var(--function)">lineTo</span>(<span style="color:var(--operator)">(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">9</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">W</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span>,<span style="color:var(--operator)">(</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span>]<span style="color:var(--operator)">+</span><span style="color:var(--number)">13</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">)*</span><span style="color:var(--variable)">z</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">H</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">2</span><span style="color:var(--operator)">)){</span>
<span style="color:var(--keyword)">if</span><span style="color:var(--operator)">(</span>!<span style="color:var(--variable)">_</span><span style="color:var(--operator)">)</span><span style="color:var(--variable)">J</span>.<span style="color:var(--function)">push</span>(<span style="color:var(--number)">0</span>,<span style="color:var(--number)">0</span><span style="color:var(--operator)">)</span>
<span style="color:var(--keyword)">else</span><span style="color:var(--operator)">{</span>
<span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span>]<span style="color:var(--operator)">+=</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">*(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">></span><span style="color:var(--number)">3</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">+=(</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">+</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">_</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">)*</span>.<span style="color:var(--number)">02</span><span style="color:var(--operator)">-</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">)/</span><span style="color:var(--number)">2</span>
~<span style="color:var(--variable)">d</span><span style="color:var(--operator)">==</span>~<span style="color:var(--operator)">(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">9</span><span style="color:var(--operator)">)</span>&<span style="color:var(--variable)">e</span><span style="color:var(--operator)">></span><span style="color:var(--number)">12</span>&<span style="color:var(--variable)">e</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">14</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">+=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">/</span><span style="color:var(--number)">4</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">*=</span>.<span style="color:var(--number)">97</span><span style="color:var(--operator)">*(</span><span style="color:var(--variable)">i</span><span style="color:var(--operator)">&lt;</span><span style="color:var(--number)">630</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">-=</span><span style="color:var(--variable)">J</span>[<span style="color:var(--variable)">i</span>]<span style="color:var(--operator)">/</span><span style="color:var(--number)">25</span>
<span style="color:var(--operator)">}}</span>
<span style="color:var(--function)">r</span>(<span style="color:var(--number)">0</span>,<span style="color:var(--number)">13</span>,<span style="color:var(--number)">70</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">X</span>.<span style="color:var(--function)">fill</span>(<span style="color:var(--operator)">)</span>

<span style="color:var(--comment)">// Make the background golden if the player has completed all the levels</span>
<span style="color:var(--comment)">// Reset the temperature timer at the start of every level</span>
<span style="color:var(--comment)">// Make the temperature bar slowly get lower</span>
<span style="color:var(--comment)">// Freeze the player if he's been playing for over a minute</span>
!<span style="color:var(--variable)">K</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">Q</span><span style="color:var(--operator)">></span><span style="color:var(--number)">4</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">t</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#ff0'</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">k</span><span style="color:var(--operator)">=</span>[<span style="color:var(--variable)">Q</span><span style="color:var(--operator)">*=</span><span style="color:var(--number)">14</span>,<span style="color:var(--variable)">Q</span><span style="color:var(--operator)">+=</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">V</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">1</span>]<span style="color:var(--operator)">:++</span><span style="color:var(--variable)">V</span><span style="color:var(--operator)">></span><span style="color:var(--number)">5e3</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">D</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>

<span style="color:var(--function)">requestAnimationFrame</span>(<span style="color:var(--variable)">l</span><span style="color:var(--operator)">)</span>
<span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">X</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span>.<span style="color:var(--variable)">getContext</span><span style="color:var(--string)">`2d`</span>

<span style="color:var(--comment)">// "V" represents the progress of the temperature bar</span>
<span style="color:var(--variable)">d</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">f</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">v</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">Q</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">V</span><span style="color:var(--operator)">=</span><span style="color:var(--number)">0</span>

<span style="color:var(--variable)">k</span><span style="color:var(--operator)">=</span>[<span style="color:var(--variable)">J</span><span style="color:var(--operator)">=</span>[]]

<span style="color:var(--comment)">// Define the default background colour</span>
<span style="color:var(--variable)">t</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'#3897'</span>

<span style="color:var(--variable)">P</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">e</span>,<span style="color:var(--variable)">b</span><span style="color:var(--operator)">)=></span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">38</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">87</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">g</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">39</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">68</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">j</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">37</span>|<span style="color:var(--variable)">e</span>.<span style="color:var(--variable)">keyCode</span><span style="color:var(--operator)">==</span><span style="color:var(--number)">65</span><span style="color:var(--operator)">?</span><span style="color:var(--variable)">h</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">b</span><span style="color:var(--operator)">:</span><span style="color:var(--number)">0</span>
<span style="color:var(--variable)">onkeydown</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span>,<span style="color:var(--number)">1</span><span style="color:var(--operator)">)</span>
<span style="color:var(--variable)">onkeyup</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">e</span><span style="color:var(--operator)">=></span><span style="color:var(--function)">P</span>(<span style="color:var(--variable)">e</span><span style="color:var(--operator)">)</span>

<span style="color:var(--variable)">a</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=>{</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">x</span><span style="color:var(--operator)">+</span><span style="color:var(--number)">1</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">=</span>~~<span style="color:var(--variable)">y</span>;<span style="color:var(--keyword)">return</span> <span style="color:var(--operator)">(</span><span style="color:var(--variable)">Math</span>.<span style="color:var(--function)">sin</span>(<span style="color:var(--variable)">y</span><span style="color:var(--operator)">*</span><span style="color:var(--variable)">x</span><span style="color:var(--operator)">*</span><span style="color:var(--number)">9</span><span style="color:var(--operator)">+</span><span style="color:var(--variable)">Q</span><span style="color:var(--operator)">)*</span><span style="color:var(--number)">6</span><span style="color:var(--operator)">)+</span><span style="color:var(--variable)">y</span><span style="color:var(--operator)">-</span><span style="color:var(--number)">15</span><span style="color:var(--operator)">}</span>
<span style="color:var(--variable)">A</span><span style="color:var(--operator)">=(</span><span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)=></span><span style="color:var(--function)">a</span>(<span style="color:var(--variable)">x</span>,<span style="color:var(--variable)">y</span><span style="color:var(--operator)">)></span><span style="color:var(--number)">0</span>
<span style="color:var(--function)">l</span>(<span style="color:var(--operator)">)</span></pre>
                        </div>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-17.png>
                            </div>
                        </div>

                        <p class = spaced>
                            The temperature bar implemented above has a timer
                            that starts at zero and counts up every frame. When
                            this number is larger than 5000, it freezes the player.
                        </p>

                        <div class = 'demo-hint top-big bottom-big'>
                            <div class = demo-hint-icon>
                                <img src = /assets/bulb.svg>
                            </div>
                            <div class = 'text'>
                                <p class = spaced>
                                    We froze the player by writing the code
                                    <span class = inline-code>d=D</span>.
                                    This works because
                                    <span class = inline-code>D</span> refers
                                    the old position of our player. By setting
                                    his active position to match his old one,
                                    the code effectively makes him "freeze."
                                </p>
                            </div>
                        </div>

                        <p class = spaced>
                            The piece of code that says
                            <span class = inline-code>Q>4?t='#ff0':</span> is
                            detecting when the player has completed all the
                            levels. Once he has,
                            <span class = inline-code>t='#ff0'</span> changes the background
                            colour.
                        </p>

                        <p class = spaced>
                            As mentioned earlier, there have also been some other
                            updates in the code. I haven't explained them because
                            they are very simple. If you're struggling to
                            understand, the commented areas explain all the
                            changes in detail.
                        </p>

                        <p class = spaced>
                            Well, believe it or not, Splash Dash has been
                            completely made from start to finish. It's been a
                            long journey, but we finally made it! However,
                            you may be wondering why the code looks longer
                            than a thousand characters. That's because we
                            haven't put it through all the packing techniques
                            that can get games as small as possible.
                        </p>

                        <p class = spaced>
                            Let's see how small we can get it in the final section of this blog.
                        </p>
                    </div>

                    <a href = #_code>
                        <h2 class = 'h2 top-big bottom-big' id = code>One Last Golf</h3>
                    </a>

                    <div class = 'text shift bottom-big'>
                        <p class = spaced>
                            We've come a long way. Now it's time to compress our
                            code into the tiny limitation of 1024 characters.
                            Fortunately, we've done all the hard work. As we've
                            coded this game, we've tried to keep our code as
                            simple and small as we can. The last stage is
                            handing our code over to a machine and see what
                            it spits out.
                        </p>

                        <p class = spaced>
                            There are a lot of JavaScript minifying tools out
                            there. One I've found especially good is a tool
                            called "Terser Online," a simple compilation of
                            two very useful minification tools. I pasted our
                            JavaScript code in the box and it has given us
                            something over 1000 characters smaller.
                        </p>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-18.png>
                            </div>
                        </div>

                        <p class = spaced>
                            How did it do that?! Essentially, terser removes anything
                            that's pointless. This can include whitespace, new lines,
                            and a few other things that are all there for the simple
                            purpose of making code easier for us to read.
                        </p>

                        <div class = 'demo-hint top-big bottom-big'>
                            <div class = demo-hint-icon>
                                <img src = /assets/bulb.svg>
                            </div>
                            <div class = 'text'>
                                <p class = spaced>
                                    Whitespace is the space between our text or
                                    code that makes it readable. Computers don't
                                    need any of this "whitespace" to run a program,
                                    because they don't care about aesthetics.
                                    Interestingly however, some spaces are vital
                                    for the computer to interpret, so tools like
                                    Terser have to detect which ones to remove.
                                </p>
                            </div>
                        </div>

                        <p class = spaced>
                            But the byte size still isn't small enough! Thankfully,
                            Terser Online also includes a feature called "Regpack,"
                            which was made by Siorki. Let's see how small we can go!
                        </p>

                        <div class = 'demo-img-container top-small-pad bottom-small-pad'>
                            <div class = view-image>
                                <img class = demo-img src = /assets/platform-game-in-1k-19.png>
                            </div>
                        </div>

                        <p class = spaced>
                            From that lengthy code we had at first, we've been
                            able to save more than 1400 characters. At the moment
                            we're just using JavaScript, so let's add our HTML
                            back in like we discussed in the outset.
                        </p>

                        <div class = 'code-holder top bottom'>
                            <div class = code-buttons>
                                <a href = /assets/splash-dash target = _blank>
                                    <div data-tip = 'run' class = 'code-run code-button-icon'>
                                        <img src = /assets/run.svg alt = 'play icon'>
                                    </div>
                                </a>
                                <div data-tip = 'copy' class = 'code-copy code-button-icon'>
                                    <img src = /assets/copy.svg alt = 'copy icon'>
                                </div>
                            </div>
                            <pre class = code><span style="color:var(--operator)">&lt;</span><span style="color:var(--variable)">canvas</span> <span style="color:var(--variable)">id</span><span style="color:var(--operator)">=</span><span style="color:var(--variable)">c</span><span style="color:var(--operator)">>&lt;</span><span style="color:var(--variable)">script</span><span style="color:var(--operator)">></span><span style="color:var(--keyword)">for</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">p</span><span style="color:var(--operator)">=</span><span style="color:var(--string)">'(e,d)Q&lt;17&amp;!PeightO0,NNNWLr(KfoKJ=d:Ikey x,y=c./2o.fillRect(+.),4,.1e==>S(e=innerd=(i-1Styl"#+=-e)*u+HA(d5,e(d,eA)|	5)M[i-d)*u+W,(&amp;&amp;(=Q=>*Math.sin(+1]==e. Codel=n=>{JWwidthWidth6,HhOHO6,ogetContext`2d`,u=(W+H)5,r=,l,f)=>l,u*f,u*fC=d,F=e,g&amp;s?f=-.18:ef.007,h?d-=.1:qd.1t,KLKs=N9,WA&amp;!	&amp;!)e%1&lt;fF,s=1,f=0	)|A||d&lt;0|d5>70C,	)f=NF)ePA)&amp;a)>k[~~d*~~e]=1R=Nx=70;x--;)Jy=30;y--;)"+~(5x)-543A()?K,1):a()>&amp;yPk[x*y]ff0",Kx4,y41p/50+x+R++.3));JK-W,NWK7L034",L-m*W/5e3,H/9r+f,.4rKd3,e0698",i=634;i-=2;o.lineTo(/9]+13))p?(]*>3(]02p*)-),~=~/9)&amp;e>12&amp;e&lt;14?f/4:*=.97*&lt;630-=]5):M.push(N0);KN13,70(R?++m>5e3?C:p9:T>4?t="#ff0":k=[T*=14,Tm=1],requestAnimationFrame(l)},f=g=h=q=s=u=T=m=p=Nk=[M=[]],t="#3897",S38|87?gI39|68?qI37|65?hINon down,1on upa(1+~~e,~~d,6d*e*9+T)+d5AaQ>Nl()'</span>;<span style="color:var(--variable)">G</span><span style="color:var(--operator)">=/</span>[^!<span style="color:var(--operator)">-</span><span style="color:var(--variable)">HMR</span><span style="color:var(--operator)">-</span>~]<span style="color:var(--operator)">/</span>.<span style="color:var(--function)">exec</span>(<span style="color:var(--variable)">p</span><span style="color:var(--operator)">)</span>;<span style="color:var(--operator)">)</span><span style="color:var(--keyword)">with</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">p</span>.<span style="color:var(--function)">split</span>(<span style="color:var(--variable)">G</span><span style="color:var(--operator)">))</span><span style="color:var(--variable)">p</span><span style="color:var(--operator)">=</span><span style="color:var(--function)">join</span>(<span style="color:var(--function)">shift</span>(<span style="color:var(--operator)">))</span>;<span style="color:var(--keyword)">eval</span><span style="color:var(--operator)">(</span><span style="color:var(--variable)">p</span><span style="color:var(--operator)">)&lt;/</span><span style="color:var(--variable)">script</span><span style="color:var(--operator)">></span></pre>
                        </div>

                        <p class = spaced>
                            Admittedly, getting the above code to fit into 1024
                            characters took some tweaking. I needed to go back and
                            change a few practices we used earlier on and rename
                            some variables. The hardest part of code golfing is
                            always the end, where even moving a letter from one
                            part of your code to another can save bytes.
                        </p>

                        <p class = spaced>
                            Well, that's all! Ironically, this blog post took
                            a complete six thousand three hundred and forty five
                            words, just to explain just a 1024 character game to you.
                            I need to get a life.
                        </p>

                        <p class = spaced>
                            Anyway, I hope this page helped
                            you understand how games like this are made. If you
                            would like help with any part, please tell me about
                            it in the comments!
                        </p>
                    </div>
                </div>

                <div class = 'content top-big-pad bottom-huge'>
                    <form class = 'comment bottom-big-pad' data-url = PlatformGameIn1K>
                        <h3 class = 'h3 top-small bottom-small center'>
                            <span class = slightly-dim>
                                Please leave a comment!
                            </span>
                        </h3>

                        <input class = form placeholder = 'name'>
                        <label for = notify class = checkbox-label>
                            <div class = checkbox-hold>
                                <input id = notify class = checkbox data-checked type = checkbox>
                            </div>
                            <span class = 'smallish slightly-dim'>Make this comment public</span>
                        </label>

                        <div class = comment-box-hold>
                            <textarea class = comment-box required contenteditable placeholder = 'Write your message here'></textarea>
                        </div>

                        <input class = form type = email placeholder = 'email (optional)'>
                        <button class = comment-send>Post Comment</button>
                        <span class = 'dim small-font shift-right right'>(Your email will never be shared or sold. <button class = popup-link data-id = terms type = button>Terms</button>)</span>
                    </form>
                </div>
            </section>

            <section class = footer>
                <div class = footer-left>
                    <span>&copy; Joachim Ford <span id = year>2025</span></span>
                    <span>All rights reserved</span>
                    <span class = top-small>
                        <form class = 'subscribe-form-tiny'>
                            <div class = flex-x>
                                <input type = email class = form placeholder = 'email' required>
                                <button class = 'send-form-button subscribe' type = submit>
                                    Subscribe
                                </button>
                            </div>
                        </form>
                    </span>
                    <div class = 'footer-socials top-small'>
                        <a href = mailto:hi@joachimford.uk target = _blank><img src = /assets/mail.svg alt = 'email icon'></a>
                        <a href = https://github.com/Hope41 target = _blank><img src = /assets/github.svg alt = 'github icon'></a>
                        <a href = https://youtube.com/@JoachimFord target = _blank><img src = /assets/youtube.svg alt = 'youtube icon'></a>
                        <a href = https://joachimford.itch.io target = _blank><img src = /assets/itch.svg alt = 'itch.io icon'></a>
                        <a href = https://hope41.bsky.social target = _blank><img src = /assets/bsky.svg alt = 'bsky logo'></a>
                    </div>
                </div>
                <div class = footer-right>
                    <a href = /index# class = basic-link>Home</a>
                    <a href = /games# class = basic-link>Games</a>
                    <a href = /projects# class = basic-link>Projects</a>
                    <a href = /blog# class = basic-link>Blog</a>
                    <a href = /news# class = basic-link>News</a>
                    <a href = /about# class = basic-link>About</a>
                    <a href = /contact# class = basic-link>Contact</a>
                </div>
            </section>
        </div>

        <div class = popup id = terms>
            <div class = popup-text-hold>
                <div class = popup-close data-id = terms>
                    <img src = /assets/close.svg>
                </div>
                <div class = popup-text>
                    <h2 class = h4><span class = gray-green>Posting a Comment</span></h2>
                    <h2 class = h2>Terms</h2>
                    <div class = 'text shift-right'>
                        <p class = spaced>
                            <span class = 'bullet-point big-pad'>
                                If you post your comment publicly, you agree to
                                have your <b>name</b> and <b>message</b> posted
                                on this website. Your comment may also appear in
                                advertisements for this site.
                            </span>
                        </p>
                        <p class = spaced>
                            <span class = 'bullet-point big-pad'>
                                By providing an email address, you will be notified
                                of any replies. I may also respond to you directly
                                via the email address provided.
                            </span>
                        </p>
                        <p class = spaced>
                            Your email will only be used for these purposes
                            and will never be published, shared or sold.
                        </p>
                        <p class = 'spaced smallish'>
                            The only catch is I get to make you a profile picture
                            based on your name
                            <img class = emoji src = /assets/Microsoft-Fluentui-Emoji-3d-Smirking-Face-3d.svg>
                        </p>
                        <button class = popup-close data-id = terms>
                            I Understand
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id = lightbox-overlay>
            <div id = lightbox-topnav>
                <div id = lightbox-copy class = lightbox-button>
                    <img src = /assets/copy.svg>
                </div>
                <div id = lightbox-download class = lightbox-button>
                    <img src = /assets/download.svg>
                </div>
                <div id = lightbox-close class = lightbox-button>
                    <img src = /assets/close.svg>
                </div>
            </div>
            <img src = /assets/ios-mission-1-thumbnail.png id = lightbox-img>
            <div id = lightbox-prev><img src = /assets/arrow-left.svg></div>
            <div id = lightbox-next><img src = /assets/arrow-right.svg></div>
        </div>

        <script src = /assets/main.js></script>
        <script src = /assets/infinite-carousel.js></script>
        <script src = /assets/hero.js></script>
        <script src = /assets/cool-text.js></script>
        <script src = /assets/popup.js></script>
        <script src = /assets/profile-interact.js></script>
        <script src = /assets/demo-carousel.js></script>
        <script src = /assets/lightbox.js></script>
        <script src = /assets/code.js></script>
    </body>
</html>